<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Stores – GRN</title>
  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:20px}
    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid #e5e7eb;padding:8px;text-align:left}
    th{background:#f3f4f6}
    a.btn, button.btn{display:inline-block;margin:6px 8px 6px 0;padding:6px 10px;border:1px solid #d1d5db;border-radius:6px;text-decoration:none;background:#fff;cursor:pointer}
    .inline-form{display:inline-block;margin-left:8px}
    .inline-form input{padding:4px 6px}
  </style>
</head>
<body>
  <h1>Stores – GRN</h1>

  <p>
    <a class="btn" href="/grn/new">New GRN</a>
    <a class="btn" href="/">Home</a>

    <!-- Simple report helpers that DO NOT use Jinja now() -->
    <a class="btn" href="/grn?report=1&start={{ today_iso }}&end={{ today_iso }}">Today</a>

    <form class="inline-form" method="get" action="/grn">
      <input type="hidden" name="report" value="1">
      <label>From</label>
      <input type="date" name="start" value="{{ today_iso }}">
      <label>To</label>
      <input type="date" name="end" value="{{ today_iso }}">
      <button class="btn" type="submit">Fetch</button>
    </form>
  </p>

  <table>
    <thead>
      <tr>
        <th>ID</th><th>Date</th><th>Supplier</th><th>RM Type</th>
        <th>Qty (kg)</th><th>Remaining (kg)</th><th>Price (₹/kg)</th>
      </tr>
    </thead>
    <tbody>
      {% for g in grns %}
      <tr>
        <td>{{ g.id }}</td>
        <td>{{ g.date }}</td>
        <td>{{ g.supplier }}</td>
        <td>{{ g.rm_type }}</td>
        <td>{{ '%.1f' % (g.qty or 0) }}</td>
        <td>{{ '%.1f' % (g.remaining_qty or 0) }}</td>
        <td>{{ '%.2f' % (g.price or 0) }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</body>
</html>
